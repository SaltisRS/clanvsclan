<!DOCTYPE html>
<html>
<head>
  <title>Ironclad VS Iron Foundry</title>
  <style>
    .accordion {
      background-color: #ffffff;
      color: #444;
      cursor: pointer;
      padding: 18px;
      width: 100%;
      border: none;
      text-align: left;
      outline: none;
      font-size: 15px;
      transition: 0.4s;
    }

    .active,
    .accordion:hover {
      background-color: #ccc;
    }

    .panel {
      padding: 0 18px;
      background-color: white;
      display: none;
      overflow: hidden;
    }

    .panel.show {
      display: block;
    }
  </style>
</head>
<body>
  <h1>Extracted Data</h1>
  <div id="accordion-container"></div>
  <script>
    // Your fetchData function (from above)
    // Your extractData function (as before)

    async function displayData() {
      const apiData = await fetchData();

      if (!apiData) {
        console.log("Failed to fetch data from API.");
        return;
      }

      const extractedData = extractData(apiData); // Use your extractData function

      const accordionContainer = document.getElementById("accordion-container");

      // Group data by tier
      const tiers = {};
      extractedData.forEach((item) => {
        if (!tiers[item.Tier]) {
          tiers[item.Tier] = [];
        }
        tiers[item.Tier].push(item);
      });

      // Create accordions for each tier
      for (const tier in tiers) {
        if (tiers.hasOwnProperty(tier)) {
          const accordionButton = document.createElement("button");
          accordionButton.classList.add("accordion");
          accordionButton.textContent = tier;
          accordionContainer.appendChild(accordionButton);

          const panel = document.createElement("div");
          panel.classList.add("panel");
          accordionContainer.appendChild(panel);

          // Display sources and items within the panel
          tiers[tier].forEach((item) => {
            const sourceElement = document.createElement("h3");
            sourceElement.textContent = `Source: ${item.Source}`;
            panel.appendChild(sourceElement);

            const itemsList = document.createElement("ul");
            item.Items.forEach((itemDetail) => {
              const itemElement = document.createElement("li");
              itemElement.textContent = `${itemDetail.name} (Points: ${itemDetail.points})`;
              itemsList.appendChild(itemElement);
            });
            panel.appendChild(itemsList);

            const multipliersElement = document.createElement("p");
            multipliersElement.textContent = `Multipliers: ${item.Multipliers.join(", ")}`;
            panel.appendChild(multipliersElement);
          });

          // Accordion functionality
          accordionButton.addEventListener("click", () => {
            accordionButton.classList.toggle("active");
            panel.classList.toggle("show");
          });
        }
      }
    }

    displayData();
    function extractData(data) {
      const results = [];
    
      for (const tier in data.tiers) {
        if (data.tiers.hasOwnProperty(tier)) {
          const sources = data.tiers[tier].sources;
    
          sources.forEach((source) => {
            const sourceName = source.name;
            const items = source.items;
            const multipliers = source.multipliers;
    
            results.push({
              Tier: tier,
              Source: sourceName,
              Items: items,
              Multipliers: multipliers,
            });
          });
        }
      }
    
      return results;
    } // Call the function to fetch and display the data
    async function fetchData() {
      let url = "http://backend:8000/api/data1";
      try {
        const response = await fetch(url); // Replace with your API URL
        const data = await response.json();
        return data;
      } catch (error) {
        console.error("Error fetching data:", error);
        return null; // Or handle the error in a way that makes sense for your app
      }
    }
    
  </script>
</body>
</html>